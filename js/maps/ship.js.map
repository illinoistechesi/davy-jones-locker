{"version":3,"sources":["ship.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module"],"mappings":"CAAA,SAAUA,EAAEC,EAAEC,EAAEC,GAAG,SAASC,EAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,IAAIE,EAAkB,mBAATC,SAAqBA,QAAQ,IAAIF,GAAGC,EAAE,OAAOA,EAAEF,GAAE,GAAI,GAAGI,EAAE,OAAOA,EAAEJ,GAAE,GAAI,IAAIK,EAAE,IAAIC,MAAM,uBAAuBN,EAAE,KAAK,MAAMK,EAAEE,KAAK,mBAAmBF,EAAE,IAAIG,EAAEX,EAAEG,IAAIS,YAAYb,EAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAG,IAAIE,EAAED,EAAEI,GAAG,GAAGL,GAAG,OAAOI,EAAEF,GAAIF,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,OAAOD,EAAEG,GAAGS,QAAkD,IAAI,IAA1CL,EAAkB,mBAATD,SAAqBA,QAAgBH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,IAAI,OAAOD,EAAvb,EAA4ba,GAAG,SAAST,EAAQU,EAAOJ,GACvd,uBAoOW","file":"../ship.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\nfunction Ship() {\n\tvar action = {\n\t\trender: function render(data, OPTION) {\n\t\t\tvar attr = {\n\t\t\t\t\"dom\": null, // ships html dom component\n\t\t\t\t\"health\": null, // ship's health bar, display as dots\n\t\t\t\t\"color\": null, // ship color\n\t\t\t\t\"name\": null, // ship's display name\n\t\t\t\t\"owner\": null,\n\t\t\t\t\"id\": null,\n\t\t\t\t\"x\": null,\n\t\t\t\t\"y\": null,\n\t\t\t\t\"z\": null,\n\t\t\t\t\"firepower\": null,\n\t\t\t\t\"hull\": null,\n\t\t\t\t\"speed\": null,\n\t\t\t\t\"range\": null,\n\t\t\t\t\"sunk\": null\n\t\t\t};\n\t\t\tfor (var keys in data) {\n\t\t\t\tattr[keys] = data[keys];\n\t\t\t}\n\n\t\t\tvar doc = document.getElementById('scene');\n\t\t\tvar ship = document.createElement('a-entity');\n\n\t\t\tship.setAttribute('position', data.x + ' ' + data.y + ' ' + data.z);\n\t\t\tif (attr.color === 'rgb(255, 255, 0)') {\n\t\t\t\tship.setAttribute('template', 'src: #submarine-template');\n\t\t\t\tship.setAttribute('class', 'submarine');\n\t\t\t} else {\n\t\t\t\tship.setAttribute('template', 'src: #boat-template');\n\t\t\t\tship.setAttribute('class', 'boat');\n\t\t\t}\n\n\t\t\tvar heart = '';\n\t\t\tfor (var i = 0; i < attr.hull; i++) {\n\t\t\t\theart += ' •';\n\t\t\t}\n\t\t\tattr.health = heart;\n\n\t\t\t// ${variable} <- variable name be lower case\n\t\t\tship.setAttribute('data-ship_color', 'color: ' + attr.color + '; metalness: 0.4;');\n\t\t\tship.setAttribute('data-ship_name', 'value: ' + attr.name + '; font: #play;');\n\t\t\tship.setAttribute('data-ship_health', 'value: ' + heart + ';');\n\n\t\t\tattr.dom = doc.appendChild(ship);\n\n\t\t\treturn attr;\n\t\t},\n\n\t\tsinkShip: function sinkShip(data, OPTION) {\n\t\t\tconsole.log('sink: ', data);\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar action = data.present.next.actions[0]; // sink action should only have a size of one\n\t\t\t\tvar ship = data.html[action.id];\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: black;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar point1 = document.createElement('a-curve-point');\n\t\t\t\tvar point2 = document.createElement('a-curve-point');\n\t\t\t\tpoint1.setAttribute('position', action.x + ' ' + action.y + ' ' + action.z);\n\t\t\t\tpoint2.setAttribute('position', action.x + ' ' + (action.y - OPTION.SinkDistance) + ' ' + action.z);\n\t\t\t\ttrack.appendChild(point1);\n\t\t\t\ttrack.appendChild(point2);\n\n\t\t\t\tship.dom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 1 0; delay: ' + OPTION.WaitTimeBetweenAction + '; dur: 3000;');\n\n\t\t\t\tship.dom.addEventListener('movingended', function () {\n\t\t\t\t\tship.dom.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\tship.dom.removeAttribute('alongpath');\n\t\t\t\t\tship.dom.setAttribute('visible', false);\n\t\t\t\t\t// shipDom.childNodes.forEach((node) => {\n\t\t\t\t\t// \tconsole.log(node);\n\t\t\t\t\t// \tnode.setAttribute('visible', false);\n\t\t\t\t\t// });\n\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\thitShip: function hitShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar action = data.present.next.actions[0];\n\t\t\t\tvar ship = data.html[action.id];\n\t\t\t\tvar heart = '';\n\n\t\t\t\tfor (var i = 0; i < data[0].health; i++) {\n\t\t\t\t\theart += ' •';\n\t\t\t\t}\n\n\t\t\t\tfor (var _i = 0; _i < ship.dom.childNodes.length; _i++) {\n\t\t\t\t\tif (ship.dom.childNodes[_i].className === 'ship-health') {\n\t\t\t\t\t\tship.dom.childNodes[_i].setAttribute('text-geometry', 'value: ' + heart + ';');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\t\t\t});\n\t\t},\n\n\t\tfireShip: function fireShip(data, OPTION) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\n\t\t\t\tvar bullet = document.createElement('a-sphere');\n\t\t\t\tvar source = document.createElement('a-curve-point');\n\t\t\t\tvar arc = document.createElement('a-curve-point');\n\t\t\t\tvar target = document.createElement('a-curve-point');\n\t\t\t\tbullet.setAttribute('color', 'gray');\n\t\t\t\tbullet.setAttribute('radius', '0.1');\n\t\t\t\tbullet.setAttribute('position', data[0].x + ' ' + data[0].y + ' ' + data[0].z);\n\t\t\t\tsource.setAttribute('position', data[0].x + ' ' + data[0].y + ' ' + data[0].z);\n\t\t\t\ttarget.setAttribute('position', data[0].atX + ' ' + data[0].atY + ' ' + data[0].atZ);\n\t\t\t\tarc.setAttribute('position', (data[0].atX + data[0].x) / 2 + \" \" + ((data[0].atY + data[0].y) / 2 + OPTION.BulletArc) + \" \" + (data[0].atZ + data[0].z) / 2);\n\t\t\t\ttrack.appendChild(source);\n\t\t\t\ttrack.appendChild(arc);\n\t\t\t\ttrack.appendChild(target);\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: red;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar path = doc.appendChild(bullet);\n\t\t\t\tpath.setAttribute('alongpath', 'curve: #track; rotate: true; constant: 0 0 1; delay: 200; dur: 500');\n\n\t\t\t\tpath.addEventListener('movingended', function () {\n\t\t\t\t\tpath.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (path.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(path);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tmoveShip: function moveShip(model, data, OPTION) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tconsole.log(data, model);\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar ship = model[data[0].id];\n\n\t\t\t\t// add a path to show movement along the path\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: blue;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\t// add current location as a starting point of the curve\n\t\t\t\tvar point = document.createElement('a-curve-point');\n\t\t\t\tpoint.setAttribute('position', ship.x + ' ' + ship.y + ' ' + ship.z);\n\t\t\t\ttrack.appendChild(point);\n\t\t\t\t// add chain-able goal locations to the curve\n\t\t\t\tvar previous = { 'x': ship.x, 'z': ship.z };\n\t\t\t\tvar xDistance = 0;\n\t\t\t\tvar zDistance = 0;\n\t\t\t\t// console.log(\"current: \", model[data[0].id])\n\t\t\t\t// console.log(\"length: \", data);\n\t\t\t\tconsole.log('past the debug');\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tpoint = document.createElement('a-curve-point');\n\t\t\t\t\tpoint.setAttribute('position', data[i].x + ' ' + data[i].y + ' ' + data[i].z);\n\t\t\t\t\txDistance += Math.abs(data[i].x - previous.x);\n\t\t\t\t\tzDistance += Math.abs(data[i].z - previous.z);\n\t\t\t\t\ttrack.appendChild(point);\n\t\t\t\t\tprevious = { 'x': data[i].x, 'y': data[i].z };\n\t\t\t\t\tif (i + 1 < data.length && data[i].x === data[i + 1].x && data[i].z === data[i + 1].z) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// define time for movement so that speed of difference distance is consistent\n\t\t\t\tvar duration = (xDistance + zDistance) * OPTION.WaitTimePerTileMoved;\n\t\t\t\tship.dom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 0 1; delay: ' + OPTION.WaitTimeBetweenAction + '; dur: ' + duration + ';');\n\t\t\t\tconsole.log('past the set attribute');\n\n\t\t\t\tship.dom.addEventListener('movingended', function () {\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\tship.dom.removeAttribute('alongpath');\n\t\t\t\t\tship.x = data[data.length - 1].x;\n\t\t\t\t\tship.y = data[data.length - 1].y;\n\t\t\t\t\tship.z = data[data.length - 1].z;\n\t\t\t\t\tconsole.log('past the updater');\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\n\treturn action;\n}\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2hpcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQ0EsU0FBUyxJQUFULEdBQWdCO0FBQ2YsS0FBSSxTQUFTO0FBQ1osVUFBUSxnQkFBQyxJQUFELEVBQU8sTUFBUCxFQUFrQjtBQUN6QixPQUFJLE9BQU87QUFDVixXQUFPLElBREcsRUFDRztBQUNiLGNBQVUsSUFGQSxFQUVNO0FBQ2hCLGFBQVMsSUFIQyxFQUdLO0FBQ2YsWUFBUSxJQUpFLEVBSUk7QUFDZCxhQUFTLElBTEM7QUFNVixVQUFNLElBTkk7QUFPVixTQUFLLElBUEs7QUFRVixTQUFLLElBUks7QUFTVixTQUFLLElBVEs7QUFVVixpQkFBYSxJQVZIO0FBV1YsWUFBUSxJQVhFO0FBWVYsYUFBUyxJQVpDO0FBYVYsYUFBUyxJQWJDO0FBY1YsWUFBUTtBQWRFLElBQVg7QUFnQkEsUUFBSyxJQUFJLElBQVQsSUFBaUIsSUFBakIsRUFBdUI7QUFDdEIsU0FBSyxJQUFMLElBQWEsS0FBSyxJQUFMLENBQWI7QUFDQTs7QUFFRCxPQUFJLE1BQU0sU0FBUyxjQUFULENBQXdCLE9BQXhCLENBQVY7QUFDQSxPQUFJLE9BQU8sU0FBUyxhQUFULENBQXVCLFVBQXZCLENBQVg7O0FBRUEsUUFBSyxZQUFMLENBQWtCLFVBQWxCLEVBQThCLEtBQUssQ0FBTCxHQUFTLEdBQVQsR0FBZSxLQUFLLENBQXBCLEdBQXdCLEdBQXhCLEdBQThCLEtBQUssQ0FBakU7QUFDQSxPQUFJLEtBQUssS0FBTCxLQUFlLGtCQUFuQixFQUF1QztBQUN0QyxTQUFLLFlBQUwsQ0FBa0IsVUFBbEIsRUFBOEIsMEJBQTlCO0FBQ0EsU0FBSyxZQUFMLENBQWtCLE9BQWxCLEVBQTJCLFdBQTNCO0FBQ0EsSUFIRCxNQUlLO0FBQ0osU0FBSyxZQUFMLENBQWtCLFVBQWxCLEVBQThCLHFCQUE5QjtBQUNBLFNBQUssWUFBTCxDQUFrQixPQUFsQixF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RjtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQSxRQUFJLFdBQVcsQ0FBQyxZQUFVLFNBQVgsSUFBc0IsT0FBTyxvQkFBNUM7QUFDQSxTQUFLLEdBQUwsQ0FBUyxZQUFULENBQXNCLFdBQXRCLEVBQW1DLDREQUEwRCxPQUFPLHFCQUFqRSxHQUF1RixTQUF2RixHQUFpRyxRQUFqRyxHQUEwRyxHQUE3STtBQUNBLFlBQVEsR0FBUixDQUFZLHdCQUFaOztBQUVBLFNBQUssR0FBTCxDQUFTLGdCQUFULENBQTBCLGFBQTFCLEVBQXlDLFlBQU07QUFDOUMsU0FBSSxNQUFNLFVBQVYsRUFBc0I7QUFDckIsVUFBSSxXQUFKLENBQWdCLEtBQWhCO0FBQ0E7O0FBRUQsWUFBTSxNQUFNLGFBQU4sRUFBTixFQUE2QjtBQUM1QixZQUFNLFdBQU4sQ0FBa0IsTUFBTSxVQUFOLENBQWlCLENBQWpCLENBQWxCO0FBQ0E7QUFDRCxhQUFRLEdBQVIsQ0FBWSxJQUFaO0FBQ0EsVUFBSyxHQUFMLENBQVMsZUFBVCxDQUF5QixXQUF6QjtBQUNBLFVBQUssQ0FBTCxHQUFTLEtBQUssS0FBSyxNQUFMLEdBQVksQ0FBakIsRUFBb0IsQ0FBN0I7QUFDQSxVQUFLLENBQUwsR0FBUyxLQUFLLEtBQUssTUFBTCxHQUFZLENBQWpCLEVBQW9CLENBQTdCO0FBQ0EsVUFBSyxDQUFMLEdBQVMsS0FBSyxLQUFLLE1BQUwsR0FBWSxDQUFqQixFQUFvQixDQUE3QjtBQUNBLGFBQVEsR0FBUixDQUFZLGtCQUFaO0FBQ0E7QUFDQSxLQWZEO0FBZ0JBLElBeERNLENBQVA7QUF5REE7QUE1TlcsRUFBYjs7QUErTkEsUUFBTyxNQUFQO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXG5mdW5jdGlvbiBTaGlwKCkge1xuXHRsZXQgYWN0aW9uID0ge1xuXHRcdHJlbmRlcjogKGRhdGEsIE9QVElPTikgPT4ge1xuXHRcdFx0bGV0IGF0dHIgPSB7XG5cdFx0XHRcdFwiZG9tXCI6IG51bGwsIC8vIHNoaXBzIGh0bWwgZG9tIGNvbXBvbmVudFxuXHRcdFx0XHRcImhlYWx0aFwiOiBudWxsLCAvLyBzaGlwJ3MgaGVhbHRoIGJhciwgZGlzcGxheSBhcyBkb3RzXG5cdFx0XHRcdFwiY29sb3JcIjogbnVsbCwgLy8gc2hpcCBjb2xvclxuXHRcdFx0XHRcIm5hbWVcIjogbnVsbCwgLy8gc2hpcCdzIGRpc3BsYXkgbmFtZVxuXHRcdFx0XHRcIm93bmVyXCI6IG51bGwsXG5cdFx0XHRcdFwiaWRcIjogbnVsbCxcblx0XHRcdFx0XCJ4XCI6IG51bGwsXG5cdFx0XHRcdFwieVwiOiBudWxsLFxuXHRcdFx0XHRcInpcIjogbnVsbCxcblx0XHRcdFx0XCJmaXJlcG93ZXJcIjogbnVsbCxcblx0XHRcdFx0XCJodWxsXCI6IG51bGwsXG5cdFx0XHRcdFwic3BlZWRcIjogbnVsbCxcblx0XHRcdFx0XCJyYW5nZVwiOiBudWxsLFxuXHRcdFx0XHRcInN1bmtcIjogbnVsbFxuXHRcdFx0fVxuXHRcdFx0Zm9yIChsZXQga2V5cyBpbiBkYXRhKSB7XG5cdFx0XHRcdGF0dHJba2V5c10gPSBkYXRhW2tleXNdO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XG5cdFx0XHRsZXQgc2hpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG5cblx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGRhdGEueCArICcgJyArIGRhdGEueSArICcgJyArIGRhdGEueik7XG5cdFx0XHRpZiAoYXR0ci5jb2xvciA9PT0gJ3JnYigyNTUsIDI1NSwgMCknKSB7XG5cdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCd0ZW1wbGF0ZScsICdzcmM6ICNzdWJtYXJpbmUtdGVtcGxhdGUnKTtcblx0XHRcdFx0c2hpcC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3N1Ym1hcmluZScpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCd0ZW1wbGF0ZScsICdzcmM6ICNib2F0LXRlbXBsYXRlJyk7XG5cdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdib2F0Jyk7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBoZWFydCA9ICcnO1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyLmh1bGw7IGkrKykge1xuXHRcdFx0XHRoZWFydCArPSAnIOKAoic7XG5cdFx0XHR9XG5cdFx0XHRhdHRyLmhlYWx0aCA9IGhlYXJ0O1xuXG5cdFx0XHQvLyAke3ZhcmlhYmxlfSA8LSB2YXJpYWJsZSBuYW1lIGJlIGxvd2VyIGNhc2Vcblx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdkYXRhLXNoaXBfY29sb3InLCAnY29sb3I6ICcrYXR0ci5jb2xvcisnOyBtZXRhbG5lc3M6IDAuNDsnKTtcblx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdkYXRhLXNoaXBfbmFtZScsICd2YWx1ZTogJythdHRyLm5hbWUrJzsgZm9udDogI3BsYXk7Jyk7XG5cdFx0XHRzaGlwLnNldEF0dHJpYnV0ZSgnZGF0YS1zaGlwX2hlYWx0aCcsICd2YWx1ZTogJytoZWFydCsnOycpO1xuXG5cdFx0XHRhdHRyLmRvbSA9IGRvYy5hcHBlbmRDaGlsZChzaGlwKTtcblxuXHRcdFx0cmV0dXJuIGF0dHI7XG5cdFx0fSxcblxuXHRcdHNpbmtTaGlwOiAoZGF0YSwgT1BUSU9OKSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZygnc2luazogJywgZGF0YSk7XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHRsZXQgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XG5cdFx0XHRcdGxldCB0cmFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmFjaycpO1xuXHRcdFx0XHRsZXQgYWN0aW9uID0gZGF0YS5wcmVzZW50Lm5leHQuYWN0aW9uc1swXTsgLy8gc2luayBhY3Rpb24gc2hvdWxkIG9ubHkgaGF2ZSBhIHNpemUgb2Ygb25lXG5cdFx0XHRcdGxldCBzaGlwID0gZGF0YS5odG1sW2FjdGlvbi5pZF07XG5cdFx0XHRcdFxuXHRcdFx0XHRsZXQgZGVidWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWRyYXctY3VydmUnKTtcblx0XHRcdFx0ZGVidWcuc2V0QXR0cmlidXRlKCdjdXJ2ZXJlZicsICcjdHJhY2snKTtcblx0XHRcdFx0ZGVidWcuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdzaGFkZXI6IGxpbmU7IGNvbG9yOiBibGFjazsnKTtcblx0XHRcdFx0ZG9jLmFwcGVuZENoaWxkKGRlYnVnKTtcblxuXHRcdFx0XHR2YXIgcG9pbnQxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHR2YXIgcG9pbnQyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHRwb2ludDEuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGFjdGlvbi54ICsgJyAnICsgYWN0aW9uLnkgKyAnICcgKyBhY3Rpb24ueik7XG5cdFx0XHRcdHBvaW50Mi5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgYWN0aW9uLnggKyAnICcgKyAoYWN0aW9uLnkgLSBPUFRJT04uU2lua0Rpc3RhbmNlKSArICcgJyArIGFjdGlvbi56KTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQxKTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQyKTtcblxuXHRcdFx0XHRzaGlwLmRvbS5zZXRBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcsICdjdXJ2ZTogI3RyYWNrOyByb3RhdGU6IHRydWU7IGNvbnN0cmFpbnQ6IDAgMSAwOyBkZWxheTogJyArIE9QVElPTi5XYWl0VGltZUJldHdlZW5BY3Rpb24gKyAnOyBkdXI6IDMwMDA7Jyk7XG5cblx0XHRcdFx0c2hpcC5kb20uYWRkRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2hpcC5kb20ucmVtb3ZlQXR0cmlidXRlKCdhbG9uZ3BhdGgnKTtcblx0XHRcdFx0XHRpZiAoZGVidWcucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdFx0ZG9jLnJlbW92ZUNoaWxkKGRlYnVnKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR3aGlsZSh0cmFjay5oYXNDaGlsZE5vZGVzKCkpIHtcblx0XHRcdFx0XHRcdHRyYWNrLnJlbW92ZUNoaWxkKHRyYWNrLmNoaWxkTm9kZXNbMF0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHNoaXAuZG9tLnJlbW92ZUF0dHJpYnV0ZSgnYWxvbmdwYXRoJyk7XG5cdFx0XHRcdFx0c2hpcC5kb20uc2V0QXR0cmlidXRlKCd2aXNpYmxlJywgZmFsc2UpO1xuXHRcdFx0XHRcdC8vIHNoaXBEb20uY2hpbGROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG5cdFx0XHRcdFx0Ly8gXHRjb25zb2xlLmxvZyhub2RlKTtcblx0XHRcdFx0XHQvLyBcdG5vZGUuc2V0QXR0cmlidXRlKCd2aXNpYmxlJywgZmFsc2UpO1xuXHRcdFx0XHRcdC8vIH0pO1xuXG5cdFx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRoaXRTaGlwOiAoZGF0YSkgPT4ge1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdFx0bGV0IGFjdGlvbiA9IGRhdGEucHJlc2VudC5uZXh0LmFjdGlvbnNbMF07XG5cdFx0XHRcdGxldCBzaGlwID0gZGF0YS5odG1sW2FjdGlvbi5pZF07XG5cdFx0XHRcdGxldCBoZWFydCA9ICcnO1xuXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YVswXS5oZWFsdGg7IGkrKykge1xuXHRcdFx0XHRcdGhlYXJ0ICs9ICcg4oCiJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5kb20uY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChzaGlwLmRvbS5jaGlsZE5vZGVzW2ldLmNsYXNzTmFtZSA9PT0gJ3NoaXAtaGVhbHRoJykge1xuXHRcdFx0XHRcdFx0c2hpcC5kb20uY2hpbGROb2Rlc1tpXS5zZXRBdHRyaWJ1dGUoJ3RleHQtZ2VvbWV0cnknLCAndmFsdWU6ICcgKyBoZWFydCArICc7Jyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0ZmlyZVNoaXA6IChkYXRhLCBPUFRJT04pID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdGxldCBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0bGV0IHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cblx0XHRcdFx0bGV0IGJ1bGxldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Etc3BoZXJlJyk7XG5cdFx0XHRcdGxldCBzb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdGxldCBhcmMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdGxldCB0YXJnZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdGJ1bGxldC5zZXRBdHRyaWJ1dGUoJ2NvbG9yJywgJ2dyYXknKTtcblx0XHRcdFx0YnVsbGV0LnNldEF0dHJpYnV0ZSgncmFkaXVzJywgJzAuMScpO1xuXHRcdFx0XHRidWxsZXQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGRhdGFbMF0ueCArICcgJyArIGRhdGFbMF0ueSArICcgJyArIGRhdGFbMF0ueik7XG5cdFx0XHRcdHNvdXJjZS5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgZGF0YVswXS54ICsgJyAnICsgZGF0YVswXS55ICsgJyAnICsgZGF0YVswXS56KTtcblx0XHRcdFx0dGFyZ2V0LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLmF0WCArICcgJyArIGRhdGFbMF0uYXRZICsgJyAnICsgZGF0YVswXS5hdFopO1xuXHRcdFx0XHRhcmMuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIChkYXRhWzBdLmF0WCtkYXRhWzBdLngpLzIgKyBcIiBcIiArICgoKGRhdGFbMF0uYXRZK2RhdGFbMF0ueSkvMikrT1BUSU9OLkJ1bGxldEFyYykgKyBcIiBcIiArIChkYXRhWzBdLmF0WitkYXRhWzBdLnopLzIpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChzb3VyY2UpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChhcmMpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZCh0YXJnZXQpO1xuXG5cdFx0XHRcdGxldCBkZWJ1ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ2N1cnZlcmVmJywgJyN0cmFjaycpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcjogbGluZTsgY29sb3I6IHJlZDsnKTtcblx0XHRcdFx0ZG9jLmFwcGVuZENoaWxkKGRlYnVnKTtcblxuXHRcdFx0XHRsZXQgcGF0aCA9IGRvYy5hcHBlbmRDaGlsZChidWxsZXQpO1xuXHRcdFx0XHRwYXRoLnNldEF0dHJpYnV0ZSgnYWxvbmdwYXRoJywgJ2N1cnZlOiAjdHJhY2s7IHJvdGF0ZTogdHJ1ZTsgY29uc3RhbnQ6IDAgMCAxOyBkZWxheTogMjAwOyBkdXI6IDUwMCcpO1xuXG5cdFx0XHRcdHBhdGguYWRkRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cGF0aC5yZW1vdmVBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcpO1xuXHRcdFx0XHRcdGlmIChkZWJ1Zy5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQoZGVidWcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdoaWxlKHRyYWNrLmhhc0NoaWxkTm9kZXMoKSkge1xuXHRcdFx0XHRcdFx0dHJhY2sucmVtb3ZlQ2hpbGQodHJhY2suY2hpbGROb2Rlc1swXSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHBhdGgucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdFx0ZG9jLnJlbW92ZUNoaWxkKHBhdGgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0bW92ZVNoaXA6IChtb2RlbCwgZGF0YSwgT1BUSU9OKSA9PiB7XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhkYXRhLCBtb2RlbCk7XG5cdFx0XHRcdGxldCBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0bGV0IHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdGxldCBzaGlwID0gbW9kZWxbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0Ly8gYWRkIGEgcGF0aCB0byBzaG93IG1vdmVtZW50IGFsb25nIHRoZSBwYXRoXG5cdFx0XHRcdGxldCBkZWJ1ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ2N1cnZlcmVmJywgJyN0cmFjaycpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcjogbGluZTsgY29sb3I6IGJsdWU7Jyk7XG5cdFx0XHRcdGRvYy5hcHBlbmRDaGlsZChkZWJ1Zyk7XG5cblx0XHRcdFx0Ly8gYWRkIGN1cnJlbnQgbG9jYXRpb24gYXMgYSBzdGFydGluZyBwb2ludCBvZiB0aGUgY3VydmVcblx0XHRcdFx0bGV0IHBvaW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHRwb2ludC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgc2hpcC54ICsgJyAnICsgc2hpcC55ICsgJyAnICsgc2hpcC56KTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQpO1xuXHRcdFx0XHQvLyBhZGQgY2hhaW4tYWJsZSBnb2FsIGxvY2F0aW9ucyB0byB0aGUgY3VydmVcblx0XHRcdFx0bGV0IHByZXZpb3VzID0geyd4Jzogc2hpcC54LCAneic6IHNoaXAuen07XG5cdFx0XHRcdGxldCB4RGlzdGFuY2UgPSAwO1xuXHRcdFx0XHRsZXQgekRpc3RhbmNlID0gMDtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJjdXJyZW50OiBcIiwgbW9kZWxbZGF0YVswXS5pZF0pXG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwibGVuZ3RoOiBcIiwgZGF0YSk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdwYXN0IHRoZSBkZWJ1ZycpO1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRwb2ludCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0XHRwb2ludC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgZGF0YVtpXS54ICsgJyAnICsgZGF0YVtpXS55ICsgJyAnICsgZGF0YVtpXS56KTtcblx0XHRcdFx0XHR4RGlzdGFuY2UgKz0gTWF0aC5hYnMoZGF0YVtpXS54IC0gcHJldmlvdXMueCk7XG5cdFx0XHRcdFx0ekRpc3RhbmNlICs9IE1hdGguYWJzKGRhdGFbaV0ueiAtIHByZXZpb3VzLnopO1xuXHRcdFx0XHRcdHRyYWNrLmFwcGVuZENoaWxkKHBvaW50KTtcblx0XHRcdFx0XHRwcmV2aW91cyA9IHsneCc6IGRhdGFbaV0ueCwgJ3knOiBkYXRhW2ldLnp9O1xuXHRcdFx0XHRcdGlmIChpICsgMSA8IGRhdGEubGVuZ3RoICYmIGRhdGFbaV0ueCA9PT0gZGF0YVtpKzFdLnggJiYgZGF0YVtpXS56ID09PSBkYXRhW2krMV0ueikge1xuXHRcdFx0XHRcdFx0aSsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIGRlZmluZSB0aW1lIGZvciBtb3ZlbWVudCBzbyB0aGF0IHNwZWVkIG9mIGRpZmZlcmVuY2UgZGlzdGFuY2UgaXMgY29uc2lzdGVudFxuXHRcdFx0XHRsZXQgZHVyYXRpb24gPSAoeERpc3RhbmNlK3pEaXN0YW5jZSkqT1BUSU9OLldhaXRUaW1lUGVyVGlsZU1vdmVkO1xuXHRcdFx0XHRzaGlwLmRvbS5zZXRBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcsICdjdXJ2ZTogI3RyYWNrOyByb3RhdGU6IHRydWU7IGNvbnN0cmFpbnQ6IDAgMCAxOyBkZWxheTogJytPUFRJT04uV2FpdFRpbWVCZXR3ZWVuQWN0aW9uKyc7IGR1cjogJytkdXJhdGlvbisnOycpO1xuXHRcdFx0XHRjb25zb2xlLmxvZygncGFzdCB0aGUgc2V0IGF0dHJpYnV0ZScpO1xuXG5cdFx0XHRcdHNoaXAuZG9tLmFkZEV2ZW50TGlzdGVuZXIoJ21vdmluZ2VuZGVkJywgKCkgPT4ge1xuXHRcdFx0XHRcdGlmIChkZWJ1Zy5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQoZGVidWcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdoaWxlKHRyYWNrLmhhc0NoaWxkTm9kZXMoKSkge1xuXHRcdFx0XHRcdFx0dHJhY2sucmVtb3ZlQ2hpbGQodHJhY2suY2hpbGROb2Rlc1swXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGRhdGEpO1xuXHRcdFx0XHRcdHNoaXAuZG9tLnJlbW92ZUF0dHJpYnV0ZSgnYWxvbmdwYXRoJyk7XG5cdFx0XHRcdFx0c2hpcC54ID0gZGF0YVtkYXRhLmxlbmd0aC0xXS54O1xuXHRcdFx0XHRcdHNoaXAueSA9IGRhdGFbZGF0YS5sZW5ndGgtMV0ueTtcblx0XHRcdFx0XHRzaGlwLnogPSBkYXRhW2RhdGEubGVuZ3RoLTFdLno7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ3Bhc3QgdGhlIHVwZGF0ZXInKTtcblx0XHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGFjdGlvbjtcbn0iXX0=\n"]}